{"version":3,"sources":["index.js"],"names":["AdminAdd","init","AdminSerials","dump","myObject","s","property","$HOST_URL","AdminServer","window","getServerInfo","option","type","url","error","success","response","res","JSON","parse","data","$","text","ajax","show","Show","attr","css","on","event","preventDefault","stopPropagation","nav_id","hide","nav","AdminMovies","AdminAnimations","AdminMusics","AdminBooks","AdminUpdate","Error","cls","beLogin","magnificPopup","open","items","src","beLogout","username","user","Cookies","get","serialize","alert","close"],"mappings":"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aAAtB,EAAqC,UAASC,KAAT,EAAe;AAChDA,UAAMC,cAAN;AACAT,MAAEE,IAAF,CAAO;AACHV,aAAK,8BADF;AAEHO,cAAKC,EAAE,aAAF,EAAiB+B,SAAjB,EAFF;AAGHxC,cAAK,MAHF;AAIHG,iBAAS,iBAAUC,QAAV,EAAoB;AACzB,gBAAIC,MAAMC,KAAKC,KAAL,CAAWH,QAAX,CAAV;AACA,gBAAGC,IAAI,OAAJ,CAAH,EAAgB;AACZoC,sBAAMpC,IAAI,OAAJ,CAAN;AACH;AACD,gBAAGA,IAAI,UAAJ,CAAH,EAAoB;AAChB8B,yBAAS9B,IAAI,UAAJ,CAAT;AACAoC,sBAAM,OAAOpC,IAAI,UAAJ,CAAP,GAAyB,SAA/B;AACAI,kBAAEsB,aAAF,CAAgBW,KAAhB;AACH;AACJ;AAdE,KAAP;AAgBH,CAlBD;;AAqBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.js","sourcesContent":["/**\r\n * Created by Administrator on 2016/8/30.\r\n */\r\n\r\n// alert(dump(Cookies.get())); //输出所有cookie值\r\n\r\n/**\r\n 打印对象所有值和属性\r\n */\r\nAdminAdd.init();\r\nAdminSerials.init();\r\nfunction dump(myObject) {\r\n    var s = \"\";\r\n    for (var property in myObject) {\r\n        s = s + \"<br> \"+property +\": \" + myObject[property] ;\r\n    }\r\n    return s;\r\n}\r\n$HOST_URL = 'http://localhost:80';\r\n\r\n\r\nvar AdminServer = ( function(window){\r\n\r\n    function getServerInfo() {\r\n        var option = {};\r\n        option = {\r\n            type:\"get\",\r\n            url:\"doAdmin.php?act=getServer\",\r\n            error:function(){},\r\n            success:function(response){\r\n                var res = JSON.parse(response),\r\n                    data = res['data'];\r\n\r\n                $(\"#server_software\").text(data['server_software']);\r\n                $(\"#server_protocol\").text(data['server_protocol']);\r\n                $(\"#php_os\").text( data['php_os'] );\r\n                $(\"#php_sapi_name\").text( data['php_sapi_name'] );\r\n                $(\"#mysql_version\").text( data['mysql_version'] );\r\n\r\n            }\r\n        }\r\n        $.ajax(option);\r\n    }\r\n    return {\r\n        show: function(){\r\n            getServerInfo();\r\n            $(\".server\").show();\r\n        }\r\n    }\r\n} )(window)\r\n\r\nvar Show = AdminServer;\r\nAdminServer.show();\r\n\r\n$(\".disabled\").attr(\"title\", \"功能未上线\").css({\"color\":\"rgba(0,0,0,0.34)\",\"cursor\":\"default\"}).on(\"click\",function(event){\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n});\r\n\r\n\r\n$('nav').on(\"click\",'a', function(event){\r\n\r\n    var nav_id = $(this).attr(\"id\");\r\n\r\n    // 默认有效的导航项需设置id，没有id的项为导航插件自动添加的项目或自定义链接。\r\n    if(!nav_id){\r\n        return;\r\n    }\r\n\r\n    event.preventDefault();\r\n\r\n    if(Show && typeof Show.hide === \"function\"){\r\n        Show.hide();\r\n    } else {\r\n        $(\"main > div\").hide();\r\n    }\r\n\r\n\r\n    var nav = {\r\n        \"server\": AdminServer,\r\n        \"list_movies\": AdminMovies,\r\n        \"list_serials\": AdminSerials,\r\n        \"list_animations\": AdminAnimations,\r\n        \"list_musics\": AdminMusics,\r\n        \"list_books\": AdminBooks,\r\n        \"update_movies\": AdminUpdate,\r\n        \"add_item\": AdminAdd,\r\n        \"update_serials\": AdminUpdate\r\n    }\r\n\r\n\r\n\r\n    if(typeof nav[nav_id] !== \"object\"){\r\n        throw new Error(\"Navigate failed:target object doesn't exited\");\r\n        return;\r\n    }\r\n\r\n    if(typeof nav[nav_id].show !== \"function\") {\r\n        throw new Error(\"Navigate failed:target object haven't show function\");\r\n        return;\r\n    }\r\n\r\n    Show = nav[nav_id];\r\n    Show.show();\r\n})\r\n\r\n\r\n// $('nav').on(\"click\",'a', function(event){\r\n//     var navName = $(this).text();\r\n//\r\n//     if(navName == \"返回前台\"){\r\n//         return;\r\n//     }\r\n//\r\n//     event.preventDefault();\r\n//\r\n//     $(\"nav .selected\").removeClass('selected');\r\n//     $(this).addClass(\"selected\");\r\n//     $(\"main > div\").hide();\r\n//     switch( navName ){\r\n//         case \"服务器\":\r\n//             $(\".server\").show();\r\n//             break;\r\n//         case \"电视剧\":\r\n//             $(\".serials\").show();\r\n//             break;\r\n//         case \"电影\":\r\n//             $(\".movies\").show();\r\n//             break;\r\n//         case \"书\":\r\n//             $(\".books\").show();\r\n//             break;\r\n//         case \"动画\":\r\n//             $(\".animations\").show();\r\n//             break;\r\n//         case \"添加\":\r\n//             $(\".serialsAdd\").show();\r\n//             break;\r\n//         case \"修改\":\r\n//             $(\".serialsUpdate\").show();\r\n//\r\n//     }\r\n//     var options = {\r\n//         type: \"GET\",\r\n//         url: $(this).attr('href'),\r\n//         error: function(request) {\r\n//             throwError(\"页面请求失败...\");\r\n//         },\r\n//         success: function(response) {\r\n//             var res = JSON.parse(response);\r\n//             var d = res.data;\r\n//             if(res[\"error\"]){\r\n//                 alert(res[\"error\"]);\r\n//                 return;\r\n//             }\r\n//\r\n//             switch( navName ){\r\n//                 case \"服务器\":\r\n//                     showServer(d);\r\n//                     break;\r\n//\r\n//                 case \"电视剧\":\r\n//                     showSerialsList(d);\r\n//                     var totalPage = Math.ceil(res[\"total\"] / res[\"pageSize\"]);\r\n//                     showPages(1, totalPage, 4);\r\n//                     break;\r\n//\r\n//                 case \"电影\":\r\n//\r\n//                     break;\r\n//                 case \"书\":\r\n//\r\n//                     break;\r\n//                 case \"动画\":\r\n//\r\n//                     break;\r\n//\r\n//                 case \"添加\":\r\n//\r\n//                     break;\r\n//\r\n//             }\r\n//\r\n//         }\r\n//     }\r\n//     $.ajax(options);\r\n// });\r\n\r\n\r\n\r\n$(\".header\").on(\"click\", \"a\", function(event) {\r\n    event.preventDefault();\r\n    var cls = $(this).attr(\"class\");\r\n    if (cls == \"logout\") {\r\n        $.ajax({\r\n            url: \"doSerialsAdmin.php?act=logout\",\r\n            success: function (data) {\r\n                if (JSON.parse(data)[\"success\"] == true) {\r\n                    beLogin();\r\n                }\r\n            }\r\n        })\r\n    }\r\n    if (cls == \"login\") {\r\n        $.magnificPopup.open({\r\n            items: {\r\n                src: \"<div class='white-popup'><form class='loginPanel'>\" +\r\n                \"<input type='text' name='username'  placeholder='Username'><br>\" +\r\n                \"<input type='password' name='password' placeholder='Password'><br>\" +\r\n                \"<input type='radio' id='autoLogin' name='autoLogin'>\" +\r\n                \"<label for='autoLogin'>Remember me</label><br><button>登录</button></form></div>\",\r\n                type: 'inline'\r\n            }\r\n        })\r\n    }\r\n})\r\n// 初始化登录状态\r\n$.ajax({\r\n    url: \"doSerialsAdmin.php?act=login\",\r\n    success:function(response){\r\n        var res = JSON.parse(response);\r\n        if(res[\"username\"]) {\r\n            beLogout(res[\"username\"]);\r\n        } else {\r\n            beLogin();\r\n        }\r\n    }\r\n})\r\n\r\n/**\r\n * 登录状态变为未登录\r\n */\r\nfunction beLogin(){\r\n    $(\".logout\").attr(\"class\", \"login\").text(\"Sign in\")\r\n    $(\".log_state\").text(\"游客您好！\");\r\n}\r\n\r\n/**\r\n * 登录状态变为已登录\r\n */\r\nfunction beLogout(username){\r\n    var user = username || Cookies.get(\"adminName\") || \"\";\r\n    if(user === \"\"){\r\n        beLogin();\r\n    } else {\r\n        $(\".login\").attr(\"class\", \"logout\").text(\"Sign out\");\r\n        $(\".log_state\").text(user);\r\n    }\r\n}\r\n\r\n// 提交登录信息\r\n// todo:表单验证\r\n$(\"body\").on(\"submit\",\".loginPanel\", function(event){\r\n    event.preventDefault();\r\n    $.ajax({\r\n        url: \"doSerialsAdmin.php?act=login\",\r\n        data:$(\".loginPanel\").serialize(),\r\n        type:'post',\r\n        success: function (response) {\r\n            var res = JSON.parse(response);\r\n            if(res[\"error\"]){\r\n                alert(res[\"error\"]);\r\n            }\r\n            if(res[\"username\"]) {\r\n                beLogout(res[\"username\"]);\r\n                alert(\"二货\" + res[\"username\"] + \"，开始干活了！\")\r\n                $.magnificPopup.close();\r\n            }\r\n        }\r\n    })\r\n})\r\n\r\n\r\n// $(\"main\").on(\"click\", '.paging a', function(event){\r\n//     event.preventDefault();\r\n//     var options = {\r\n//         type: \"GET\",\r\n//         url: $(this).attr('href'),\r\n//         error: function (request) {\r\n//             throwError(\"页面请求失败...\");\r\n//         },\r\n//         success: function (response) {\r\n//             var res = JSON.parse(response);\r\n//             var d = res.data;\r\n//             showSerialsList(d);\r\n//             var totalPage = Math.ceil(res[\"total\"] / 8);\r\n//             showPages(res[\"page\"], totalPage, 4);\r\n//         }\r\n//     }\r\n//     $.ajax(options);\r\n// })\r\n// $('main').on(\"click\", \".paging a\", function(event) {\r\n//     event.preventDefault();\r\n//\r\n//     //alert('http://localhost:80'+$(this).attr('href'));\r\n//     var options = {\r\n//         type: \"GET\",\r\n//         url: $HOST_URL + $(this).attr('href'),\r\n//         error: function(request) {\r\n//             alert(\"分页请求失败...\");\r\n//         },\r\n//         success: function(d) {\r\n//             $(\"main\").html(d);\r\n//         }\r\n//     }\r\n//     $.ajax(options);\r\n// })\r\n\r\n\r\n// $('main').on(\"click\", \"a\", function(event){\r\n//     if($(this).text() == \"修改\" || $(this).text() == \"取消\"){\r\n//         event.preventDefault();\r\n//         // var tr = this.parentNode.parentNode,\r\n//         //     tds = tr.childNodes,\r\n//         //     i, len;\r\n//         // for(i = 1, len = tds.length; i < len; i++){\r\n//         //     $(tds[i]).attr(\"contentEditable\", \"true\");\r\n//         // }\r\n//\r\n//     }\r\n//\r\n//     if($(this).text() == \"删除\" ){\r\n//         event.preventDefault();\r\n//         if(confirm(\"确认要删除这条记录？\")){\r\n//             var options = {\r\n//                 type: \"GET\",\r\n//                 url: $(this).attr(\"href\"),\r\n//                 error: function(request) {\r\n//                     throwError(\"连接失败\");\r\n//                 },\r\n//                 success: function(response) {\r\n//                     var res = JSON.parse(response);\r\n//                     var d = res.data;\r\n//                     showSerialsList(d);\r\n//                 }\r\n//             }\r\n//             $.ajax(options);\r\n//         }\r\n//     }\r\n// })\r\n"]}